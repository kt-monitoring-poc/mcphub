# MCPHub v3.1.0 - 00ì‹œ ì •ê° ì‹¤í–‰ ê¸°ëŠ¥

## ğŸ“… ë¦´ë¦¬ì¦ˆ ì •ë³´

- **ë²„ì „**: 3.1.0
- **ë¦´ë¦¬ì¦ˆ ë‚ ì§œ**: 2025-08-07
- **íƒ€ì…**: Feature Update
- **í˜¸í™˜ì„±**: v3.0.xì™€ ì™„ì „ í˜¸í™˜

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥ ì¶”ê°€

### ğŸ•› íŠ¹ì • ì‹œê°„ ì‹¤í–‰ ìŠ¤ì¼€ì¤„ëŸ¬

MCPHub í™˜ê²½ë³€ìˆ˜ ìë™ ê´€ë¦¬ ì‹œìŠ¤í…œì´ ì´ì œ **ë§¤ì¼ 00ì‹œ ì •ê°** ë˜ëŠ” **ì‚¬ìš©ì ì§€ì • ì‹œê°„**ì— ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ğŸ“‹ ê¸°ì¡´ vs ì‹ ê·œ

| êµ¬ë¶„ | v3.0 (ê¸°ì¡´) | v3.1 (ì‹ ê·œ) |
|------|-------------|-------------|
| **ì‹¤í–‰ ë°©ì‹** | ì„œë²„ ì‹œì‘ í›„ Nì‹œê°„ë§ˆë‹¤ | ë§¤ì¼ íŠ¹ì • ì‹œê°„ì— ì‹¤í–‰ |
| **ì˜ˆì¸¡ì„±** | ì„œë²„ ì¬ì‹œì‘ì‹œ ì‹œê°„ ë³€ê²½ | í•­ìƒ ë™ì¼í•œ ì‹œê°„ |
| **ì„¤ì •** | intervalHoursë§Œ ì§€ì› | scheduledTime ì¶”ê°€ |
| **UI** | ì‹œê°„ ê°„ê²© ì…ë ¥ë§Œ | ì‹¤í–‰ ë°©ì‹ ì„ íƒ + ì‹œê°„ ì„¤ì • |

#### ğŸ”§ ìƒˆë¡œìš´ ì„¤ì • ì˜µì…˜

```typescript
interface SchedulerConfig {
  enabled: boolean;
  intervalHours: number;        // ê¸°ì¡´
  autoCleanup: boolean;         // ê¸°ì¡´
  maxOrphanedKeys: number;      // ê¸°ì¡´
  scheduledTime?: string;       // ğŸ†• NEW: "HH:MM" í˜•ì‹
}
```

## ğŸ“ ë³€ê²½ëœ íŒŒì¼ ëª©ë¡

### ğŸ–¥ï¸ ë°±ì—”ë“œ ë³€ê²½ì‚¬í•­

#### 1. `src/services/envVarScheduler.ts` (ëŒ€í­ ê°œì„ )

**ì¶”ê°€ëœ ì£¼ìš” ë©”ì„œë“œ:**
- `scheduleAtSpecificTime()`: íŠ¹ì • ì‹œê°„ ìŠ¤ì¼€ì¤„ë§ ë¡œì§
- `scheduleWithInterval()`: ê¸°ì¡´ ê°„ê²© ê¸°ë°˜ ìŠ¤ì¼€ì¤„ë§
- `getNextScheduledTime()`: ë‹¤ìŒ ì‹¤í–‰ ì‹œê°„ ê³„ì‚°
- ê°œì„ ëœ `updateConfig()`: ìŠ¤ì¼€ì¤„ ë³€ê²½ì‹œ ìë™ ì¬ì‹œì‘

**í•µì‹¬ ë¡œì§:**
```typescript
// ë‹¤ìŒ ì‹¤í–‰ ì‹œê°„ ê³„ì‚°
private getNextScheduledTime(): Date {
  const now = new Date();
  const [hours, minutes] = this.config.scheduledTime!.split(':').map(Number);
  
  const nextRun = new Date();
  nextRun.setHours(hours, minutes, 0, 0);
  
  // ì˜¤ëŠ˜ì˜ ì˜ˆì • ì‹œê°„ì´ ì´ë¯¸ ì§€ë‚¬ë‹¤ë©´ ë‚´ì¼ë¡œ ì„¤ì •
  if (nextRun <= now) {
    nextRun.setDate(nextRun.getDate() + 1);
  }
  
  return nextRun;
}
```

#### 2. `src/routes/index.ts` (API í™•ì¥)

**ì¶”ê°€ëœ íŒŒë¼ë¯¸í„°:**
```typescript
// POST /api/admin/env-scheduler/config
const { enabled, intervalHours, autoCleanup, maxOrphanedKeys, scheduledTime } = req.body;

scheduler.updateConfig({
  // ... ê¸°ì¡´ íŒŒë¼ë¯¸í„°ë“¤
  scheduledTime: scheduledTime !== undefined ? scheduledTime : undefined  // ğŸ†•
});
```

#### 3. `src/server.ts` (ì´ˆê¸°í™” ë¡œì§)

**ê¸°ë³¸ê°’ ë³€ê²½:**
```typescript
const schedulerConfig = {
  enabled: process.env.NODE_ENV === 'production',
  intervalHours: 24,
  autoCleanup: false,
  maxOrphanedKeys: 10,
  scheduledTime: "00:00"  // ğŸ†• ê¸°ë³¸ê°’: ë§¤ì¼ 00ì‹œ
};
```

### ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ ë³€ê²½ì‚¬í•­

#### 1. `frontend/src/pages/admin/EnvVarManagementPage.tsx` (UI ê°œì„ )

**ìƒˆë¡œìš´ ìƒíƒœ ì¶”ê°€:**
```typescript
const [schedulerConfig, setSchedulerConfig] = useState({
  enabled: false,
  intervalHours: 24,
  autoCleanup: false,
  maxOrphanedKeys: 10,
  scheduledTime: "00:00"  // ğŸ†•
});
```

**UI ì»´í¬ë„ŒíŠ¸ ì¶”ê°€:**
- **ì‹¤í–‰ ë°©ì‹ ì„ íƒ**: ë“œë¡­ë‹¤ìš´ (íŠ¹ì • ì‹œê°„ vs ì£¼ê¸°ì  ì‹¤í–‰)
- **ì‹œê°„ ì…ë ¥**: HTML time picker (`<input type="time">`)
- **ìƒíƒœ í‘œì‹œ**: "ë§¤ì¼ HH:MM" í˜•ì‹ìœ¼ë¡œ í‘œì‹œ

#### 2. `frontend/src/layouts/AdminLayout.tsx` (ë©”ë‰´ ì¶”ê°€)

**ê´€ë¦¬ì ë©”ë‰´ì— í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬ ì¶”ê°€:**
```typescript
{
  path: '/admin/env-vars',
  label: 'í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬',
  icon: <Database className="h-5 w-5" />
}
```

#### 3. `frontend/src/App.tsx` (ë¼ìš°íŒ… ì¶”ê°€)

**ìƒˆë¡œìš´ ë¼ìš°íŠ¸:**
```tsx
<Route path="/admin/env-vars" element={<EnvVarManagementPage />} />
```

## ğŸ”Œ API ë³€ê²½ì‚¬í•­

### ìƒˆë¡œìš´ ìš”ì²­/ì‘ë‹µ í˜•ì‹

#### GET /api/admin/env-scheduler/status

**ì‘ë‹µ ë³€ê²½:**
```json
{
  "success": true,
  "data": {
    "isRunning": true,
    "config": {
      "enabled": true,
      "intervalHours": 24,
      "autoCleanup": false,
      "maxOrphanedKeys": 10,
      "scheduledTime": "00:00"  // ğŸ†•
    },
    "nextRunTime": "2025-08-07T15:00:00.000Z"
  }
}
```

#### POST /api/admin/env-scheduler/config

**ìš”ì²­ ë³€ê²½:**
```json
{
  "enabled": true,
  "intervalHours": 24,
  "autoCleanup": false,
  "maxOrphanedKeys": 10,
  "scheduledTime": "00:00"  // ğŸ†• ì„ íƒì‚¬í•­
}
```

## ğŸ® ì‚¬ìš©ë²•

### 1. í™˜ê²½ë³€ìˆ˜ ì„¤ì •

```bash
# ê°œë°œ í™˜ê²½ì—ì„œ ìŠ¤ì¼€ì¤„ëŸ¬ í™œì„±í™”
ENV_SCHEDULER_ENABLED=true pnpm start:dev

# ê¸°ë³¸ê°’ìœ¼ë¡œ 00ì‹œ ì •ê° ì‹¤í–‰
# ë³„ë„ ì„¤ì • ì—†ì´ ìë™ìœ¼ë¡œ ë§¤ì¼ 00:00ì— ì‹¤í–‰
```

### 2. APIë¡œ ì‹œê°„ ë³€ê²½

```bash
# ë§¤ì¼ 00ì‹œ ì •ê° ì„¤ì •
curl -X POST http://localhost:3000/api/admin/env-scheduler/config \
  -H "Content-Type: application/json" \
  -d '{"enabled": true, "scheduledTime": "00:00"}'

# ìƒˆë²½ 2ì‹œ 30ë¶„ ì„¤ì •  
curl -X POST http://localhost:3000/api/admin/env-scheduler/config \
  -H "Content-Type: application/json" \
  -d '{"enabled": true, "scheduledTime": "02:30"}'

# ê¸°ì¡´ ê°„ê²© ë°©ì‹ìœ¼ë¡œ ë³€ê²½ (12ì‹œê°„ë§ˆë‹¤)
curl -X POST http://localhost:3000/api/admin/env-scheduler/config \
  -H "Content-Type: application/json" \
  -d '{"enabled": true, "intervalHours": 12, "scheduledTime": null}'
```

### 3. ì›¹ UI ì‚¬ìš©ë²•

1. **http://localhost:5173/admin/env-vars** ì ‘ì†
2. **"ì‹¤í–‰ ë°©ì‹"** ì„ íƒ:
   - `íŠ¹ì • ì‹œê°„ì— ì‹¤í–‰`: ë§¤ì¼ ì§€ì •ëœ ì‹œê°„
   - `ì£¼ê¸°ì  ì‹¤í–‰`: Nì‹œê°„ë§ˆë‹¤ ë°˜ë³µ
3. **ì‹œê°„ ì„¤ì •**:
   - íŠ¹ì • ì‹œê°„: time pickerë¡œ HH:MM ì…ë ¥
   - ì£¼ê¸°ì : ìˆ«ì ì…ë ¥ (1-168ì‹œê°„)
4. **"ì„¤ì • ì €ì¥"** í´ë¦­

## âš¡ ì„±ëŠ¥ ë° ì•ˆì •ì„±

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
- **ê¸°ì¡´**: setTimeout/setInterval 1ê°œ 
- **ì‹ ê·œ**: setTimeout + setInterval ì¡°í•© (ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë™ì¼)

### ì •í™•ì„±
- **íŠ¹ì • ì‹œê°„ ëª¨ë“œ**: ë§¤ì¼ ì •í™•íˆ ì§€ì •ëœ ì‹œê°„ì— ì‹¤í–‰
- **ìë™ ë³´ì •**: ì‹œìŠ¤í…œ ì‹œê°„ ë³€ê²½ ì‹œì—ë„ ì˜¬ë°”ë¥¸ ì‹œê°„ ê³„ì‚°

### ì¥ì•  ëŒ€ì‘
- **ìŠ¤ì¼€ì¤„ëŸ¬ ì¬ì‹œì‘**: ì„¤ì • ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ì´ì „ ìŠ¤ì¼€ì¤„ ì •ë¦¬ í›„ ì¬ì‹œì‘
- **ì—ëŸ¬ ì²˜ë¦¬**: ì˜ëª»ëœ ì‹œê°„ í˜•ì‹ ì…ë ¥ ì‹œ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›
- **ë¡œê·¸ ê¸°ë¡**: ëª¨ë“  ìŠ¤ì¼€ì¤„ë§ ë³€ê²½ì‚¬í•­ ìƒì„¸ ë¡œê·¸

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### Q: ì‹œê°„ ì„¤ì •ì´ ë°˜ì˜ë˜ì§€ ì•Šì•„ìš”
```bash
# ìŠ¤ì¼€ì¤„ëŸ¬ ìƒíƒœ í™•ì¸
curl http://localhost:3000/api/admin/env-scheduler/status

# enabled: trueì¸ì§€ í™•ì¸
# scheduledTimeì´ ì˜¬ë°”ë¥¸ í˜•ì‹ì¸ì§€ í™•ì¸ ("HH:MM")
```

### Q: ì—¬ì „íˆ ê°„ê²© ê¸°ë°˜ìœ¼ë¡œ ì‹¤í–‰ë¼ìš”
```bash
# scheduledTimeì„ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •
curl -X POST http://localhost:3000/api/admin/env-scheduler/config \
  -d '{"scheduledTime": "00:00"}'
```

### Q: ë‹¤ìŒ ì‹¤í–‰ ì‹œê°„ì´ ì´ìƒí•´ìš”
- ì‹œê°„ëŒ€ ì„¤ì • í™•ì¸: ì„œë²„ ë¡œì»¬ ì‹œê°„ ê¸°ì¤€
- í•œêµ­ ì‹œê°„ 00:00 = UTC 15:00 (ì—¬ë¦„ì‹œê°„ ê³ ë ¤)

## ğŸš€ í–¥í›„ ê³„íš

### v3.2 ì˜ˆì • ê¸°ëŠ¥
- **ì£¼ê°„ ìŠ¤ì¼€ì¤„**: íŠ¹ì • ìš”ì¼ì—ë§Œ ì‹¤í–‰
- **ë‹¤ì¤‘ ì‹œê°„ëŒ€**: ì—¬ëŸ¬ ì‹œê°„ì— ì‹¤í–‰
- **ì¡°ê±´ë¶€ ì‹¤í–‰**: ê³ ì•„ í‚¤ ê°œìˆ˜ì— ë”°ë¥¸ ì‹¤í–‰ ì—¬ë¶€ ê²°ì •
- **ì•Œë¦¼ ì—°ë™**: ìŠ¬ë™/ì´ë©”ì¼ ì‹¤í–‰ ê²°ê³¼ í†µì§€

### ì¥ê¸° ë¡œë“œë§µ
- **í¬ë¡  í‘œí˜„ì‹**: ë” ë³µì¡í•œ ìŠ¤ì¼€ì¤„ë§ ì§€ì›
- **ì‹¤í–‰ íˆìŠ¤í† ë¦¬**: ê³¼ê±° ì‹¤í–‰ ê¸°ë¡ ë° ê²°ê³¼ ì €ì¥
- **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ì‹¤í–‰ ì‹œê°„ ë° ì²˜ë¦¬ëŸ‰ ë¶„ì„

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [í™˜ê²½ë³€ìˆ˜ ìë™í™” ì‹œìŠ¤í…œ ê°€ì´ë“œ](../mcphub-env-var-system.md)
- [API ë ˆí¼ëŸ°ìŠ¤](../api-reference.md)
- [ê´€ë¦¬ì ê°€ì´ë“œ](../admin-guide.md)

---

**ì‘ì„±ì¼**: 2025-08-07  
**ì‘ì„±ì**: MCPHub ê°œë°œíŒ€  
**ê²€í† ì**: AI Assistant  
**ìŠ¹ì¸ì**: jungchihoon
